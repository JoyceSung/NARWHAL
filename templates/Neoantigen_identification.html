{% extends '_nav_banner_modal.html' %}
{% load static %}
{% block css %}
    <!-- Bootstrap core CSS -->
    <!-- Custom styles for this template -->
    <link rel="stylesheet" href="{% static 'css/jquery.uploadfile.css' %}" type="text/css">
{% endblock css %}
{% block content %}
<h1 style="white-space:nowrap;color:#0C324C;" class="mt-5">Neoantigen identification</h1>
    
<script data-turbolinks-track="true" src="../static/js/jquery/jquery-1.11.1.min.js"></script>
    <script data-turbolinks-track="true" src="../static/js/jquery/bootstrap.min.js"></script>
    <script data-turbolinks-track="true" src="../static/js/jquery/bootstrap-select.min.js"></script>
    <script data-turbolinks-track="true" src="../static/js/jquery/jquery-ui-1.10.4.custom.min.js"></script>
    <script data-turbolinks-track="true" src="../static/js/jquery/jquery.iframe-transport.js"></script>
    <script data-turbolinks-track="true" src="../static/js/jquery/turbolinks.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script data-turbolinks-track="true" src="../static/js/jquery/select2.js"></script>
<div class="content col-md-0" id="get-started">  
</div>

<style type="text/css">
h4 {
      text-indent: 25px;
    }
.tab { margin-left: 20px; }

</style>

<!-- <! Select data types> -->
  <div class="card text-dark mb-3" style="background-color: #f4f8ff;">
    <div class="card-heading">
    <h3 class="card-header" style="background-color: #d0e0fa;">Input data types</h3></div>
    <div class="card-body">
        In this step, please select input data types. You can select DNA-seq, RNA-seq, or both of them.<br />
        <div id="data_type">
        <label><input type="checkbox" name="data_type" id="DNA_seq" value="DNA_seq"/> DNA-seq</label>
        <label><input type="checkbox" name="data_type" id="RNA_seq" value="RNA_seq"/> RNA-seq</label>
        </div>
    </div>


<!-- <! DNA pipeline> -->
<!-- <! Step 1. data upload> -->
<form action="{% url 'dna_neo_result' %}" method="POST" target="_self" id="dna">
{% csrf_token %}
<div id="DNA_pipeline">


  <!-- <! email> -->
  <div class="card text-dark mb-3" style="background-color: #f4f8ff;">
    <div class="card-heading">
    <h3 class="card-header" style="background-color: #d0e0fa;">Basic Information</h3></div>
    <div class="card-body">
        <p>please provide your basic information.</p>
        <div class="form-group">
            <label for="email">Email address:</label>
            <input type="email" class="form-control" name="email_dna" id="email_dna" />
        </div>
        <p>Please re-enter your Email for comfirmation.</p>
        <div class="form-group">
            <label for="email">Re-enter Email address:</label>
            <input type="email" class="form-control" name="re_enter_dna" id="re_enter_dna" />
        </div>
    </div>
    
    <div class="card-heading">
    <h3 class="card-header" style="background-color: #d0e0fa;">Step 1-1. DNA Reads Upload (Tumor sample)</h3></div>
    <div class="card-body">
    Select a method for uploading files:<br />
    <label class="radio-inline">
        <input type="radio" name="dna_tumor_upload_method" id="dna_tumor_from_browser" value="dna_tumor_from_browser" checked />From browser
    </label>
    <label class="radio-inline">
        <input type="radio" name="dna_tumor_upload_method" id="dna_tumor_from_url" value="dna_tumor_from_url"/>From URLs
    </label>
        <input type="hidden" id="dna_T_upload_method" name="dna_T_upload_method" value=""/>
            <div id="dna_tumor_browser_upload">
                <p>Please upload your <b> tumor DNA-seq </b> files R1 and R2 here. Only allow <b>.fastq.gz</b> format. Maximum size for each file: <b>20 GB</b>. Please note that uploading your files may take some time, so please refrain from refreshing the page while the data is being uploaded.</p>
                <div id="dna_tumor_upload_area">
                    <div id="fileuploader_dna_tumor"></div>
                    <div id="dna_tumor_upload_button" class="btn btn-primary start">
                        <span>Start upload</span>
                        <p>{{msg}}</p>
                    </div>
                </div>
            </div>

    <div id="dna_tumor_url_upload">
        <p>Please provide the Google Drive file IDs (e.g., https://drive.google.com/file/d/<b>Google Drive file ID</b> /view) of your
                            sequencing files in R1 and R2 fields. Using a share link from Google Drive is available.
                            Only allow <b>.fastq</b>/<b>.fq</b> and <b>.gz</b> format.</p>
        <label for="url_dna_tumor_R1">R1:</label><div id="url_dna_tumor_R1_err" style="color:red;"></div>
        <input type="url" class="form-control" id="url_dna_tumor_R1" name="url_dna_tumor_R1" style="margin-bottom: 10px;" />
        <input type="hidden" id="confirmed_url_dna_tumor_R1" name="confirmed_url_dna_tumor_R1" value="" />
        <label for="url_dna_tumor_R2">R2:</label><div id="url_dna_tumor_R2_err" style="color:red;"></div>
        <input type="url" class="form-control" id="url_dna_tumor_R2" name="url_dna_tumor_R2" style="margin-bottom: 10px;" />
        <input type="hidden" id="confirmed_url_dna_tumor_R2" name="confirmed_url_dna_tumor_R2" value="" />
        <div id="dna_tumor_url_confirm_button" class="btn btn-primary start">
          <i class="glyphicon glyphicon-cloud-download"></i>
                <span>Confirm URLs</span>
        </div>
    </div>

    </div>
  </div>



  <div class="card text-dark mb-3" style="background-color: #f4f8ff;"> <!--quality check normal-->
    <div class="card-heading">
    <h3 class="card-header" style="background-color: #d0e0fa;">Step 1-2. DNA Reads Upload (Normal sample)</h3></div>
    <div class="card-body">
    Select a method for uploading files:<br />
    <label class="radio-inline">
        <input type="radio" name="dna_normal_upload_method" id="dna_normal_from_browser" value="dna_normal_from_browser" checked />From browser
    </label>
    <label class="radio-inline">
        <input type="radio" name="dna_normal_upload_method" id="dna_normal_from_url" value="dna_normal_from_url"/>From URLs
    </label>
        <input type="hidden" id="dna_N_upload_method" name="dna_N_upload_method" value=""/>
            <div id="dna_normal_browser_upload">
                <p>Please upload your <b> normal DNA-seq </b> files R1 and R2 here. Only allow <b>.fastq.gz</b> format. Maximum size for each file: <b>20 GB</b>. Please note that uploading your files may take some time, so please refrain from refreshing the page while the data is being uploaded.</p>
                <div id="dna_normal_upload_area">
                    <div id="fileuploader_dna_normal"></div>
                    <div id="dna_normal_upload_button" class="btn btn-primary start">
                        <span>Start upload</span>
                        <p>{{msg}}</p>
                    </div>
                </div>
            </div>

    <div id="dna_normal_url_upload">
        <p>Please provide the Google Drive file IDs (e.g., https://drive.google.com/file/d/<b>Google Drive file ID</b> /view) of your
        sequencing files in R1 and R2 fields. Using a share link from Google Drive is available.
        Only allow <b>.fastq</b>/<b>.fq</b> and <b>.gz</b> format.</p>        
        <label for="url_dna_normal_R1">R1:</label><div id="url_dna_normal_R1_err" style="color:red;"></div>
        <input type="url" class="form-control" id="url_dna_normal_R1" name="url_dna_normal_R1" style="margin-bottom: 10px;" />
        <input type="hidden" id="confirmed_url_dna_normal_R1" name="confirmed_url_dna_normal_R1" value="" />
        <label for="url_dna_normal_R2">R2:</label><div id="url_dna_normal_R2_err" style="color:red;"></div>
        <input type="url" class="form-control" id="url_dna_normal_R2" name="url_dna_normal_R2" style="margin-bottom: 10px;" />
        <input type="hidden" id="confirmed_url_dna_normal_R2" name="confirmed_url_dna_normal_R2" value="" />
        <div id="dna_normal_url_confirm_button" class="btn btn-primary start">
          <i class="glyphicon glyphicon-cloud-download"></i>
                <span>Confirm URLs</span>
        </div>
    </div>
        <input type="hidden" id="upload_id" name="upload_id" value="" />
    </div>
  </div>

<!-- <! Step 2. HLA type selection> -->
  <div class="card text-dark mb-3" style="background-color: #f4f8ff;"> 
    <div class="card-heading">
    <h3 class="card-header" style="background-color: #d0e0fa;">Step 2. HLA genotype selection</h3></div>
    <div class="card-body">
      Before binding affinity prediction, please select specific HLA genotypes.
      Personal HLA types will be predicted during analysis if select "Personal HLA types". Manual selection is also provided to select specific HLA types.<br/>
      <p></p>
    <label class="radio-inline">
        <input type="radio" name="dna_hla_upload_method" id="dna_hla_in_process" value="dna_hla_in_process" checked /> Personal HLA types
    </label>
    <label class="radio-inline">
        <input type="radio" name="dna_hla_upload_method" id="dna_hla_from_bottom" value="dna_hla_from_bottom" /> Manual selection
    </label>
    <input type="hidden" id="dna_hla_upload_method" name="dna_hla_upload_method" value="" />

    <!-- Include in the step -->
    <div id="dna_hla_process">
        <p></p>
        <br>Personal HLA types will be predicted during analysis, and the step of HLA binding prediction will be conducted based on the predicted HLA types.</b>
    </div>

    <!-- Select HLA types -->
    <div id="dna_hla_bottom">
        <p></p>
        <br>Based on HLA major allele group frequencies.
        <p>Maximum number of HLA types: <b>8</b></p>
        <div class="selcenter">
            <select class="DNA-HLA-multiple" id="DNA-HLA-multiple" name="DNA-HLA-multiple" multiple="multiple">
              {% for hla_type in hla_list %}
              <option value={{hla_type}}>{{hla_type}}</option>
              {% endfor %}
            </select>
        </div>
        </div>
    </div>
  </div>

<!-- <! Step 3. ic 50 standard> -->
<div class="card text-dark mb-3" style="background-color: #f4f8ff;"> <!--Taxonomic Abundance-->
    <div class="card-heading">
    <h3 class="card-header" style="background-color: #d0e0fa;">Step 3. Peptide-HLA binding affinity</h3></div>
    <div class="card-body">
        In this step, we provide <i>pvactools</i> to predict binding affinity scores between peptides and specific HLA(s). The default standard of ic50 is as followed, and the standard can be adjusted in customized mode. <b>Noted that stronger binding affinity has lower ic50 number!</b><br/>
    <br><b>No binding (ic50 &#62; 500) | Weak binding (500 &#8805; ic50 &#62; 250) | Intermediate (250 &#8805; ic50 &#62; 50) | Strong binding (50 &#8805; ic50)</b></br>

    <label class="radio-inline">
        <input type="radio" name="dna_ic50_setting" id="dna_ic50_default" value="default" checked />Default Settings
    </label>
    <label class="radio-inline">
        <input type="radio" name="dna_ic50_setting" id="dna_ic50_custom" value="custom" />Customized
    </label>
    <table class="table table-striped table-condensed" name="dna_ic50_table">
            <thead>
              <tr>
                <th>Quast settings</th>
                <th>Values</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Maximum ic50 for <b>Strong binding</b></td>
                <td style="width: 50%">
                    <div class="form-group">
                      <label><input onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" name="dna_max_ic_strong" id="dna_max_ic_strong" type="number" min="0" max="10000" step="10" value="50" /> [default: 50]</label>
                    </div>
                </td>
              </tr>
            </tbody>
            <tbody>
              <tr>
                <td>Maximum ic50 for <b>Intermediate binding</b></td>
                <td style="width: 50%">
                    <div class="form-group">
                      <label><input onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" name="dna_max_ic_inter" id="dna_max_ic_inter" type="number" min="0" max="10000" step="10" value="250" /> [default: 250]</label>
                    </div>
                </td>
              </tr>
            </tbody>
            <tbody>
              <tr>
                <td>Maximum ic50 for <b>Weak binding</b></td>
                <td style="width: 50%">
                    <div class="form-group">
                      <label><input onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" name="dna_max_ic_weak" id="dna_max_ic_weak" type="number" min="0" max="10000" step="10" value="500" /> [default: 500]</label>
                    </div>
                </td>
              </tr>
            </tbody>
    </table>

    </div>
  </div>


  <!-- Step 4. LC-MS/MS -->
  <div class="card text-dark mb-3" style="background-color: #f4f8ff;"> <!--quality check-->
    <div class="card-heading">
    <h3 class="card-header" style="background-color: #d0e0fa;">Step 4. LC-MS/MS peptides Upload (optional)</h3></div>
    <div class="card-body">
    <p><b> Once an incorrect or missing LC-MS/MS file upload, we will employ the IEDB database as a viable alternative to generate aeTSA. </b></p>
    Select a method for uploading files:<br />
    <label class="radio-inline">
      <input type="radio" name="dna_mass_upload_method" id="dna_mass_from_browser" value="dna_mass_from_browser" checked />From browser
  </label>
  <label class="radio-inline">
      <input type="radio" name="dna_mass_upload_method" id="dna_mass_from_url" value="dna_mass_from_url"/>From URLs
  </label>
      <input type="hidden" id="dna_Ms_upload_method" name="dna_Ms_upload_method" value=""/>
      <div id="dna_mass_browser_upload">
        <p>Please upload your <b> FASTA </b> files consisting of peptide sequences from LC-MS/MS here. Only allow <b>.fasta.gz</b> format.</p><p> Maximum size for each file: <b>1 GB</b>.</p>
        <div id="fileuploader_dna_mass"></div>
      </div>
      
      <div id="dna_mass_url_upload">
        <p>Please provide the Google Drive file IDs (e.g., https://drive.google.com/file/d/<b>Google Drive file ID</b> /view) of your
          peptide sequencing files in fasta format. Using a share link from Google Drive is available.
          Only allow <b>.fasta.gz</b> format.</p>
          <label for="url_dna_Ms">Peptide:</label><div id="url_dna_Ms_err" style="color:red;"></div>
          <input type="url" class="form-control" id="url_dna_Ms" name="url_dna_Ms" style="margin-bottom: 10px;" />
          <input type="hidden" id="dna_mass_confirmed_url" name="dna_mass_confirmed_url" value="" />
          <div id="dna_mass_url_confirm_button" class="btn btn-primary start">
            <i class="glyphicon glyphicon-cloud-download"></i>
                  <span>Confirm the URL</span>
          </div>
      </div>
      
      </div>
    </div>

    <div class="card-heading">
    <h3 class="card-header" style="background-color: #d0e0fa;">Step 5. Privacy Statement</h3></div>
    <div class="card-body">
      NARWHAL NEVER shares users' uploaded data and results with others. All data and metadata of one task will be removed automatically from the server without any copies after <b>7 days</b> of the report generated.
    <p></p>
    <input class="form-check-input" type="checkbox" name="dna_accept_privacy_statement" id="dna_accept_privacy_statement" value="accept" />
    <label class="form-check-label" for="dna_accept_privacy_statement">I have read the Privacy Statement of NARWHAL and accept NARWHAL to process my upload data.</label>
    </div>
  </div>
  <div id="dna_submission_panel">
    <div class="card-heading">
    <h3 class="card-header" style="background-color: #d0e0fa;">Step 6. Data submission</h3></div>
    <div class="card-body">
      <button class="btn btn-default btn-success"  type="submit" id="submit_dna">Submit</button>
    </div>
  </div>
</form>



<!-- RNA pipeline -->
<form action="{% url 'rna_neo_result' %}" method="POST" target="_blank" id="rna">
{% csrf_token %}
<div id="RNA_pipeline">

<!-- email -->
  <div class="card text-dark mb-3" style="background-color: #f4f8ff;">
    <div class="card-heading">
    <h3 class="card-header" style="background-color: #d0e0fa;">Basic Information</h3></div>
    <div class="card-body">
        <p>please provide your basic information.</p>
        <div class="form-group">
            <label for="email">Email address:</label>
            <input type="email" class="form-control" name="email_rna" id="email_rna" />
        </div>
        <p>Please re-enter your Email for comfirmation.</p>
        <div class="form-group">
            <label for="email">Re-enter Email address:</label>
            <input type="email" class="form-control" name="re_enter_rna" id="re_enter_rna" />
        </div>
    </div>

  <!--quality check-->
  <!--quality check tumor-->
    <div class="card-heading">
    <h3 class="card-header" style="background-color: #d0e0fa;">Step 1-1. RNA Reads Upload (Tumor sample)</h3></div>
    <div class="card-body">
    Select a method for uploading files:<br />
    <label class="radio-inline">
        <input type="radio" name="rna_tumor_upload_method" id="rna_tumor_from_browser" value="rna_tumor_from_browser" checked />From browser
    </label>
    <label class="radio-inline">
        <input type="radio" name="rna_tumor_upload_method" id="rna_tumor_from_url" value="rna_tumor_from_url"/>From URLs
    </label>
        <input type="hidden" id="rna_T_upload_method" name="rna_T_upload_method" value=""/>
            <div id="rna_tumor_browser_upload">
                <p>Please upload your <b> tumor RNA-seq </b> files R1 and R2 here. Only allow <b>.fastq.gz</b> format. Maximum size for each file: <b>20 GB</b>. Please note that uploading your files may take some time, so please refrain from refreshing the page while the data is being uploaded.</p>
                <div id="rna_tumor_upload_area">
                    <div id="fileuploader_rna_tumor"></div>
                    <div id="rna_tumor_upload_button" class="btn btn-primary start">
                        <span>Start upload</span>
                        <p>{{msg}}</p>
                    </div>
                </div>
            </div>

    <div id="rna_tumor_url_upload">
        <p>Please provide the Google Drive file IDs (e.g., https://drive.google.com/file/d/<b>Google Drive file ID</b> /view) of your
        sequencing files in R1 and R2 fields. Using a share link from Google Drive is available.
        Only allow <b>.fastq</b>/<b>.fq</b> and <b>.gz</b> format.</p>
        <label for="url_rna_tumor_R1">R1:</label><div id="url_rna_tumor_R1_err" style="color:red;"></div>
        <input type="url" class="form-control" id="url_rna_tumor_R1" name="url_rna_tumor_R1" style="margin-bottom: 10px;" />
        <input type="hidden" id="confirmed_url_rna_tumor_R1" name="confirmed_url_rna_tumor_R1" value="" />
        <label for="url_rna_tumor_R2">R2:</label><div id="url_rna_tumor_R2_err" style="color:red;"></div>
        <input type="url" class="form-control" id="url_rna_tumor_R2" name="url_rna_tumor_R2" style="margin-bottom: 10px;" />
        <input type="hidden" id="confirmed_url_rna_tumor_R2" name="confirmed_url_rna_tumor_R2" value="" />
        <div id="rna_tumor_url_confirm_button" class="btn btn-primary start">
          <i class="glyphicon glyphicon-cloud-download"></i>
                <span>Confirm URLs</span>
        </div>
    </div>

    </div>
  </div>



  <div class="card text-dark mb-3" style="background-color: #f4f8ff;"> <!--quality check normal-->
    <div class="card-heading">
    <h3 class="card-header" style="background-color: #d0e0fa;">Step 1-2. RNA Reads Upload (Normal sample)</h3></div>
    <div class="card-body">
    Select a method for uploading files:<br />
    <label class="radio-inline">
        <input type="radio" name="rna_normal_upload_method" id="rna_normal_from_browser" value="rna_normal_from_browser" checked />From browser
    </label>
    <label class="radio-inline">
        <input type="radio" name="rna_normal_upload_method" id="rna_normal_from_url" value="rna_normal_from_url"/>From URLs
    </label>
        <input type="hidden" id="rna_N_upload_method" name="rna_N_upload_method" value=""/>
            <div id="rna_normal_browser_upload">
                <p>Please upload your <b> normal RNA-seq </b> files R1 and R2 here. Only allow <b>.fastq.gz</b> format. Maximum size for each file: <b>20 GB</b>. Please note that uploading your files may take some time, so please refrain from refreshing the page while the data is being uploaded.</p>
                <div id="rna_normal_upload_area">
                    <div id="fileuploader_rna_normal"></div>
                    <div id="rna_normal_upload_button" class="btn btn-primary start">
                        <span>Start upload</span>
                        <p>{{msg}}</p>
                    </div>
                </div>
            </div>

    <div id="rna_normal_url_upload">
        <p>Please provide the Google Drive file IDs (e.g., https://drive.google.com/file/d/<b>Google Drive file ID</b> /view) of your
        sequencing files in R1 and R2 fields. Using a share link from Google Drive is available.
        Only allow <b>.fastq</b>/<b>.fq</b> and <b>.gz</b> format.</p>
        <label for="url_rna_normal_R1">R1:</label><div id="url_rna_normal_R1_err" style="color:red;"></div>
        <input type="url" class="form-control" id="url_rna_normal_R1" name="url_rna_normal_R1" style="margin-bottom: 10px;" />
        <input type="hidden" id="confirmed_url_rna_normal_R1" name="confirmed_url_rna_normal_R1" value="" />
        <label for="url_rna_normal_R2">R2:</label><div id="url_rna_normal_R2_err" style="color:red;"></div>
        <input type="url" class="form-control" id="url_rna_normal_R2" name="url_rna_normal_R2" style="margin-bottom: 10px;" />
        <input type="hidden" id="confirmed_url_rna_normal_R2" name="confirmed_url_rna_normal_R2" value="" />
        <div id="rna_normal_url_confirm_button" class="btn btn-primary start">
          <i class="glyphicon glyphicon-cloud-download"></i>
                <span>Confirm URLs</span>
        </div>
    </div>
        <input type="hidden" id="upload_id_rna" name="upload_id_rna" value="" />
    </div>
  </div>

<!-- <! Variant calling parameter> -->
<div class="card text-dark mb-3" style="background-color: #f4f8ff;"> <!--Taxonomic Abundance-->
    <div class="card-heading">
    <h3 class="card-header" style="background-color: #d0e0fa;">Step 2. Variant calling</h3></div>
    <div class="card-body">
        In this step, we provide <i>Varscan</i> to call somatic mutation from RNA sequencing.<br />
    <label class="radio-inline">
        <input type="radio" name="variant_calling_setting" id="variant_default" value="default" checked />Default Settings
    </label>
    <label class="radio-inline">
        <input type="radio" name="variant_calling_setting" id="variant_custom" value="custom" />Customized
    </label>
    <table class="table table-striped table-condensed" name="variant_table">
            <thead>
              <tr>
                <th>Quast settings</th>
                <th>Values</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>minimum coverage in normal & tumor to call variant (&#62;=0)</td>
                <td style="width: 50%">
                    <div class="form-group">
                      <label><input onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" name="min_coverage" type="number" min="0" step="1" value="8" /> [default: 8]</label>
                    </div>
                </td>
              </tr>
            </tbody>
            <tbody>
              <tr>
                <td>minimum coverage in normal to call somatic (&#62;=0)</td>
                <td style="width: 50%">
                    <div class="form-group">
                      <label><input onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" name="min_coverage_normal" type="number" min="0" step="1" value="8" /> [default: 8]</label>
                    </div>
                </td>
              </tr>
            </tbody>
            <tbody>
              <tr>
                <td>minimum coverage in tumor to call somatic (&#62;=0)</td>
                <td style="width: 50%">
                    <div class="form-group">
                      <label><input onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" name="min_coverage_tumor" type="number" min="0" step="1" value="8" /> [default: 8]</label>
                    </div>
                </td>
              </tr>
            </tbody>
    </table>

    </div>
  </div>

<!-- <! Expression level parameter> -->
<div class="card text-dark mb-3" style="background-color: #f4f8ff;"> <!--Taxonomic Abundance-->
    <div class="card-heading">
    <h3 class="card-header" style="background-color: #d0e0fa;">Step 3. RNA expression level filtering</h3></div>
    <div class="card-body">
        In this step, we perform RNA expression level filtering to filtering out variants with low expression levels.<br />
    <label class="radio-inline">
        <input type="radio" name="expression_setting" id="expression_default" value="default" checked />Default Settings
    </label>
    <label class="radio-inline">
        <input type="radio" name="expression_setting" id="expression_custom" value="custom" />Customized
    </label>
    <table class="table table-striped table-condensed" name="expression_table">
            <thead>
              <tr>
                <th>Quast settings</th>
                <th>Values</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>minimal threshold of tumor RNA expression level (unit: tpm)</td>
                <td style="width: 50%">
                    <div class="form-group">
                      <label><input name="tumor_expression_threshold" type="number" min="0.0" step="0.5" value="1.0" /> [default: 1.0]</label>
                    </div>
                </td>
              </tr>
            </tbody>
            <tbody>
              <tr>
                <td>minimal ratio of tumor RNA expression level to normal RNA expression level</td>
                <td style="width: 50%">
                    <div class="form-group">
                      <label><input name="minimal_expression_ratio" type="number" min="0.0" step="1.0" value="0.0" /> [default: 0.0 (none)]</label>
                    </div>
                </td>
              </tr>
            </tbody>
    </table>

    </div>
  </div>

<!-- HLA type selection -->
<div class="card text-dark mb-3" style="background-color: #f4f8ff;"> 
  <div class="card-heading">
  <h3 class="card-header" style="background-color: #d0e0fa;">Step 4. HLA genotype selection</h3></div>
  <div class="card-body">
    Before binding affinity prediction, please select specific HLA genotypes.
    Personal HLA types will be predicted during analysis if select "Personal HLA types". Manual selection is also provided to select specific HLA types.<br/>
    <p></p>
  <label class="radio-inline">
      <input type="radio" name="rna_hla_upload_method" id="rna_hla_in_process" value="rna_hla_in_process" checked /> Personal HLA types
  </label>
  <label class="radio-inline">
      <input type="radio" name="rna_hla_upload_method" id="rna_hla_from_bottom" value="rna_hla_from_bottom" /> Manual selection
  </label>
  <input type="hidden" id="rna_hla_upload_method" name="rna_hla_upload_method" value="" />

  <!-- Include in the step -->
  <div id="rna_hla_process">
      <p></p>
      <br>Personal HLA types will be predicted during analysis, and the step of HLA binding prediction will be conducted based on the predicted HLA types.</b>
  </div>

    <!-- <! Select HLA types> -->
    <div id="rna_hla_bottom">
        <br>Based on HLA major allele group frequencies, default HLA types are HLA-A*02:01, A*11:01, A*24:02, and A*33:03.
        <p>Maximum number of HLA types: <b>20</b></p>
        <div class="selcenter">
            <select class="RNA-HLA-multiple" id="RNA-HLA-multiple" name="RNA-HLA-multiple" multiple="multiple">
              {% for hla_type in hla_list %}
              <option value={{hla_type}}>{{hla_type}}</option>
              {% endfor %}          
              <!-- <option value="HLA-A*01:01">HLA-A*01:01</option>
                        <option value="HLA-A*02:01">HLA-A*02:01</option>
                        <option value="HLA-A*02:02">HLA-A*02:02</option>
                        <option value="HLA-A*02:03">HLA-A*02:03</option>
                        <option value="HLA-A*02:05">HLA-A*02:05</option>
                        <option value="HLA-A*02:06">HLA-A*02:06</option>
                        <option value="HLA-A*02:07">HLA-A*02:07</option>
                        <option value="HLA-A*02:11" selected="selected">HLA-A*02:11</option>
                        <option value="HLA-A*02:12">HLA-A*02:12</option>
                        <option value="HLA-A*02:16">HLA-A*02:16</option>
                        <option value="HLA-A*02:17">HLA-A*02:17</option>
                        <option value="HLA-A*02:19">HLA-A*02:19</option>
                        <option value="HLA-A*02:50">HLA-A*02:50</option>
                        <option value="HLA-A*03:01">HLA-A*03:01</option>
                        <option value="HLA-A*11:01" selected="selected">HLA-A*11:01</option>
                        <option value="HLA-A*23:01">HLA-A*23:01</option>
                        <option value="HLA-A*24:02" selected="selected">HLA-A*24:02</option>
                        <option value="HLA-A*24:03">HLA-A*24:03</option>
                        <option value="HLA-A*25:01">HLA-A*25:01</option>
                        <option value="HLA-A*26:01">HLA-A*26:01</option>
                        <option value="HLA-A*26:02">HLA-A*26:02</option>
                        <option value="HLA-A*26:03">HLA-A*26:03</option>
                        <option value="HLA-A*29:02">HLA-A*29:02</option>
                        <option value="HLA-A*30:01">HLA-A*30:01</option>
                        <option value="HLA-A*30:02">HLA-A*30:02</option>
                        <option value="HLA-A*31:01">HLA-A*31:01</option>
                        <option value="HLA-A*32:01">HLA-A*32:01</option>
                        <option value="HLA-A*32:07">HLA-A*32:07</option>
                        <option value="HLA-A*32:15">HLA-A*32:15</option>
                        <option value="HLA-A*33:03" selected="selected">HLA-A*33:03</option>
                        <option value="HLA-A*66:01">HLA-A*66:01</option>
                        <option value="HLA-A*68:01">HLA-A*68:01</option>
                        <option value="HLA-A*68:02">HLA-A*68:02</option>
                        <option value="HLA-A*68:23">HLA-A*68:23</option>
                        <option value="HLA-A*69:01">HLA-A*69:01</option>
                        <option value="HLA-A*80:01">HLA-A*80:01</option>
                        <option value="HLA-B*07:02">HLA-B*07:02</option>
                        <option value="HLA-B*08:01">HLA-B*08:01</option>
                        <option value="HLA-B*08:02">HLA-B*08:02</option>
                        <option value="HLA-B*08:03">HLA-B*08:03</option>
                        <option value="HLA-B*14:02">HLA-B*14:02</option>
                        <option value="HLA-B*15:01">HLA-B*15:01</option>
                        <option value="HLA-B*15:02">HLA-B*15:02</option>
                        <option value="HLA-B*15:03">HLA-B*15:03</option>
                        <option value="HLA-B*15:09">HLA-B*15:09</option>
                        <option value="HLA-B*15:17">HLA-B*15:17</option>
                        <option value="HLA-B*18:01">HLA-B*18:01</option>
                        <option value="HLA-B*27:05">HLA-B*27:05</option>
                        <option value="HLA-B*27:20">HLA-B*27:20</option>
                        <option value="HLA-B*35:01">HLA-B*35:01</option>
                        <option value="HLA-B*35:03">HLA-B*35:03</option>
                        <option value="HLA-B*38:01">HLA-B*38:01</option>
                        <option value="HLA-B*39:01">HLA-B*39:01</option>
                        <option value="HLA-B*40:01">HLA-B*40:01</option>
                        <option value="HLA-B*40:02">HLA-B*40:02</option>
                        <option value="HLA-B*40:13">HLA-B*40:13</option>
                        <option value="HLA-B*42:01">HLA-B*42:01</option>
                        <option value="HLA-B*44:02">HLA-B*44:02</option>
                        <option value="HLA-B*44:03">HLA-B*44:03</option>
                        <option value="HLA-B*45:01">HLA-B*45:01</option>
                        <option value="HLA-B*46:01">HLA-B*46:01</option>
                        <option value="HLA-B*48:01">HLA-B*48:01</option>
                        <option value="HLA-B*51:01">HLA-B*51:01</option>
                        <option value="HLA-B*53:01">HLA-B*53:01</option>
                        <option value="HLA-B*54:01">HLA-B*54:01</option>
                        <option value="HLA-B*57:01">HLA-B*57:01</option>
                        <option value="HLA-B*58:01">HLA-B*58:01</option>
                        <option value="HLA-B*58:02">HLA-B*58:02</option>
                        <option value="HLA-B*73:01">HLA-B*73:01</option>
                        <option value="HLA-B*83:01">HLA-B*83:01</option>
                        <option value="HLA-C*03:03">HLA-C*03:03</option>
                        <option value="HLA-C*04:01">HLA-C*04:01</option>
                        <option value="HLA-C*05:01">HLA-C*05:01</option>
                        <option value="HLA-C*06:02">HLA-C*06:02</option>
                        <option value="HLA-C*07:01">HLA-C*07:01</option>
                        <option value="HLA-C*07:02">HLA-C*07:02</option>
                        <option value="HLA-C*08:02">HLA-C*08:02</option>
                        <option value="HLA-C*12:03">HLA-C*12:03</option>
                        <option value="HLA-C*14:02">HLA-C*14:02</option>
                        <option value="HLA-C*15:02">HLA-C*15:02</option> -->
            </select>
        </div>
        </div>
    </div>
  </div>

  <!-- <! Step 5. ic 50 standard> -->
<div class="card text-dark mb-3" style="background-color: #f4f8ff;"> <!--Taxonomic Abundance-->
    <div class="card-heading">
    <h3 class="card-header" style="background-color: #d0e0fa;">Step 5. Peptide-HLA binding affinity</h3></div>
    <div class="card-body">
        In this step, we provide <i>pvactools</i> to predict binding affinity scores between peptides and specific HLA(s). The default standard of ic50 is as followed, and the standard can be adjusted in customized mode. <b>Noted that stronger binding affinity has lower ic50 number!</b><br/>
    <br><b>No binding (ic50 &#62; 500) | Weak binding (500 &#8805; ic50 &#62; 250) | Intermediate (250 &#8805; ic50 &#62; 50) | Strong binding (50 &#8805; ic50)</b></br>

    <label class="radio-inline">
        <input type="radio" name="rna_ic50_setting" id="rna_ic50_default" value="default" checked />Default Settings
    </label>
    <label class="radio-inline">
        <input type="radio" name="rna_ic50_setting" id="rna_ic50_custom" value="custom" />Customized
    </label>
    <table class="table table-striped table-condensed" name="rna_ic50_table">
            <thead>
              <tr>
                <th>Quast settings</th>
                <th>Values</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Maximum ic50 for <b>Strong binding</b></td>
                <td style="width: 50%">
                    <div class="form-group">
                      <label><input onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" name="rna_max_ic_strong" id="rna_max_ic_strong" type="number" min="0" max="10000" step="10" value="50" /> [default: 50]</label>
                    </div>
                </td>
              </tr>
            </tbody>
            <tbody>
              <tr>
                <td>Maximum ic50 for <b>Intermediate binding</b></td>
                <td style="width: 50%">
                    <div class="form-group">
                      <label><input onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" name="rna_max_ic_inter" id="rna_max_ic_inter" type="number" min="0" max="10000" step="10" value="250" /> [default: 250]</label>
                    </div>
                </td>
              </tr>
            </tbody>
            <tbody>
              <tr>
                <td>Maximum ic50 for <b>Weak binding</b></td>
                <td style="width: 50%">
                    <div class="form-group">
                      <label><input onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" name="rna_max_ic_weak" id="rna_max_ic_weak" type="number" min="0" max="10000" step="10" value="500" /> [default: 500]</label>
                    </div>
                </td>
              </tr>
            </tbody>
    </table>

    </div>
  </div>

  <!-- Step 6. LC-MS/MS -->
  <div class="card text-dark mb-3" style="background-color: #f4f8ff;"> <!--quality check-->
    <div class="card-heading">
    <h3 class="card-header" style="background-color: #d0e0fa;">Step 6. LC-MS/MS peptides Upload (optional)</h3></div>
    <div class="card-body">
      <p><b> Once an incorrect or missing LC-MS/MS file upload, we will employ the IEDB database as a viable alternative to generate aeTSA. </b></p>
    Select a method for uploading files:<br />
    <label class="radio-inline">
      <input type="radio" name="rna_mass_upload_method" id="rna_mass_from_browser" value="rna_mass_from_browser" checked />From browser
  </label>
  <label class="radio-inline">
      <input type="radio" name="rna_mass_upload_method" id="rna_mass_from_url" value="rna_mass_from_url"/>From URLs
  </label>
      <input type="hidden" id="rna_Ms_upload_method" name="rna_Ms_upload_method" value=""/>
      <div id="rna_mass_browser_upload">
        <p>Please upload your <b> FASTA </b> files consisting of peptide sequences from LC-MS/MS here. Only allow <b>.fasta.gz</b> format.</p><p> Maximum size for each file: <b>1 GB</b>.</p>
        <div id="fileuploader_rna_mass"></div>
      </div>
      
      <div id="rna_mass_url_upload">
        <p>Please provide the Google Drive file IDs (e.g., https://drive.google.com/file/d/<b>Google Drive file ID</b> /view) of your
          peptide sequencing files in fasta format. Using a share link from Google Drive is available.
          Only allow <b>.fasta.gz</b> format.</p>
          <label for="url_rna_Ms">Peptide:</label><div id="url_rna_Ms_err" style="color:red;"></div>
          <input type="url" class="form-control" id="url_rna_Ms" name="url_rna_Ms" style="margin-bottom: 10px;" />
          <input type="hidden" id="rna_mass_confirmed_url" name="rna_mass_confirmed_url" value="" />
          <div id="rna_mass_url_confirm_button" class="btn btn-primary start">
            <i class="glyphicon glyphicon-cloud-download"></i>
                  <span>Confirm the URL</span>
          </div>
      </div>
      
      </div>
    </div>
    <div class="card-heading" style="background-color: #d0e0fa;">
    <h3 class="card-header">Step 7. Privacy Statement</h3></div>
    <div class="card-body">
      NARWHAL NEVER shares users' uploaded data and results with others. All data and metadata of one task will be removed automatically from the server without any copies after <b>7 days</b> of the report generated.
    <p></p>
    <input class="form-check-input" type="checkbox" name="rna_accept_privacy_statement" id="rna_accept_privacy_statement" value="accept" />
    <label class="form-check-label" for="rna_accept_privacy_statement">I have read the Privacy Statement of NARWHAL and accept NARWHAL to process my upload data.</label>
    </div>
  </div>
  <div id="rna_submission_panel">
    <div class="card-heading" style="background-color: #d0e0fa;">
    <h3 class="card-header">Step 7. Data submission</h3></div>
    <div class="card-body">
      <button class="btn btn-default btn-success" type="submit" id="submit_rna">Submit</button>
    </div>
  </div>
</form>

<!-- RNA + DNA pipeline -->
<form action="{% url 'drna_neo_result' %}" method="POST" target="_blank" id="drna">
  {% csrf_token %}
  <div id="DNA_with_RNA_pipeline">
  
  <!-- email -->
    <div class="card text-dark mb-3" style="background-color: #f4f8ff;">
      <div class="card text-dark mb-3" style="background-color: #f4f8ff;">
      <h3 class="card-header" style="background-color: #d0e0fa;">Basic Information</h3></div>
      <div class="card-body">
          <p>please provide your basic information.</p>
          <div class="form-group">
              <label for="email">Email address:</label>
              <input type="email" class="form-control" name="email_drna" id="email_drna" />
          </div>
          <p>Please re-enter your Email for comfirmation.</p>
          <div class="form-group">
              <label for="email">Re-enter Email address:</label>
              <input type="email" class="form-control" name="re_enter_drna" id="re_enter_drna" />
          </div>
      </div>
  
    <!--quality check-->
    <!-- DNA-seq -->
      <div class="card-heading">
      <h3 class="card-header" style="background-color: #d0e0fa;">Step 1-1. DNA Reads Upload (Tumor sample)</h3></div>
      <div class="card-body">
      Select a method for uploading files:<br/>
      <label class="radio-inline">
          <input type="radio" name="rdna_tumor_upload_method" id="rdna_tumor_from_browser" value="rdna_tumor_from_browser" checked />From browser
      </label>
      <label class="radio-inline">
          <input type="radio" name="rdna_tumor_upload_method" id="rdna_tumor_from_url" value="rdna_tumor_from_url"/>From URLs
      </label>
          <input type="hidden" id="rdna_T_upload_method" name="rdna_T_upload_method" value=""/>
              <div id="rdna_tumor_browser_upload">
                  <p>Please upload your <b> tumor DNA-seq </b> files R1 and R2 here. Only allow <b>.fastq.gz</b> format. Maximum size for each file: <b>20 GB</b>. Please note that uploading your files may take some time, so please refrain from refreshing the page while the data is being uploaded.</p>
                  <div id="rdna_tumor_upload_area">
                      <div id="fileuploader_rdna_tumor"></div>
                      <div id="rdna_tumor_upload_button" class="btn btn-primary start">
                          <span>Start upload</span>
                          <p>{{msg}}</p>
                      </div>
                  </div>
              </div>
  
      <div id="rdna_tumor_url_upload">
          <p>Please provide the Google Drive file IDs (e.g., https://drive.google.com/file/d/<b>Google Drive file ID</b> /view) of your
                              sequencing files in R1 and R2 fields. Using a share link from Google Drive is available.
                              Only allow <b>.fastq</b>/<b>.fq</b> and <b>.gz</b> format.</p>
          <label for="url_rdna_tumor_R1">R1:</label><div id="url_rdna_tumor_R1_err" style="color:red;"></div>
          <input type="url" class="form-control" id="url_rdna_tumor_R1" name="url_rdna_tumor_R1" style="margin-bottom: 10px;" />
          <input type="hidden" id="confirmed_url_rdna_tumor_R1" name="confirmed_url_rdna_tumor_R1" value="" />
          <label for="url_rdna_tumor_R2">R2:</label><div id="url_rdna_tumor_R2_err" style="color:red;"></div>
          <input type="url" class="form-control" id="url_rdna_tumor_R2" name="url_rdna_tumor_R2" style="margin-bottom: 10px;" />
          <input type="hidden" id="confirmed_url_rdna_tumor_R2" name="confirmed_url_rdna_tumor_R2" value="" />
          <div id="rdna_tumor_url_confirm_button" class="btn btn-primary start">
            <i class="glyphicon glyphicon-cloud-download"></i>
                  <span>Confirm URLs</span>
          </div>
      </div>
  
      </div>
    </div>
    <div class="card text-dark mb-3" style="background-color: #f4f8ff;"> <!--quality check normal-->
      <div class="card-heading">
      <h3 class="card-header" style="background-color: #d0e0fa;">Step 1-2. DNA Reads Upload (Normal sample)</h3></div>
      <div class="card-body">
      Select a method for uploading files:<br />
      <label class="radio-inline">
          <input type="radio" name="rdna_normal_upload_method" id="rdna_normal_from_browser" value="rdna_normal_from_browser" checked />From browser
      </label>
      <label class="radio-inline">
          <input type="radio" name="rdna_normal_upload_method" id="rdna_normal_from_url" value="rdna_normal_from_url"/>From URLs
      </label>
          <input type="hidden" id="rdna_N_upload_method" name="rdna_N_upload_method" value=""/>
              <div id="rdna_normal_browser_upload">
                  <p>Please upload your <b> normal DNA-seq </b> files R1 and R2 here. Only allow <b>.fastq.gz</b> format. Maximum size for each file: <b>20 GB</b>. Please note that uploading your files may take some time, so please refrain from refreshing the page while the data is being uploaded.</p>
                  <div id="rdna_normal_upload_area">
                      <div id="fileuploader_rdna_normal"></div>
                      <div id="rdna_normal_upload_button" class="btn btn-primary start">
                          <span>Start upload</span>
                          <p>{{msg}}</p>
                      </div>
                  </div>
              </div>
  
      <div id="rdna_normal_url_upload">
          <p>Please provide the Google Drive file IDs (e.g., https://drive.google.com/file/d/<b>Google Drive file ID</b> /view) of your
          sequencing files in R1 and R2 fields. Using a share link from Google Drive is available.
          Only allow <b>.fastq</b>/<b>.fq</b> and <b>.gz</b> format.</p>        
          <label for="url_rdna_normal_R1">R1:</label><div id="url_rdna_normal_R1_err" style="color:red;"></div>
          <input type="url" class="form-control" id="url_rdna_normal_R1" name="url_rdna_normal_R1" style="margin-bottom: 10px;" />
          <input type="hidden" id="confirmed_url_rdna_normal_R1" name="confirmed_url_rdna_normal_R1" value="" />
          <label for="url_rdna_normal_R2">R2:</label><div id="url_rdna_normal_R2_err" style="color:red;"></div>
          <input type="url" class="form-control" id="url_rdna_normal_R2" name="url_rdna_normal_R2" style="margin-bottom: 10px;" />
          <input type="hidden" id="confirmed_url_rdna_normal_R2" name="confirmed_url_rdna_normal_R2" value="" />
          <div id="rdna_normal_url_confirm_button" class="btn btn-primary start">
            <i class="glyphicon glyphicon-cloud-download"></i>
                  <span>Confirm URLs</span>
          </div>
      </div>
      </div>
    </div>

    <!-- RNA-seq -->
      <div class="card text-dark mb-3" style="background-color: #f4f8ff;"> <!--quality check tumor-->
      <div class="card-heading">
      <h3 class="card-header" style="background-color: #d0e0fa;">Step 2-1. RNA Reads Upload (Tumor sample)</h3></div>
      <div class="card-body">
      Select a method for uploading files:<br />
      <label class="radio-inline">
          <input type="radio" name="drna_tumor_upload_method" id="drna_tumor_from_browser" value="drna_tumor_from_browser" checked />From browser
      </label>
      <label class="radio-inline">
          <input type="radio" name="drna_tumor_upload_method" id="drna_tumor_from_url" value="drna_tumor_from_url"/>From URLs
      </label>
          <input type="hidden" id="drna_T_upload_method" name="drna_T_upload_method" value=""/>
              <div id="drna_tumor_browser_upload">
                  <p>Please upload your <b> tumor RNA-seq </b> files R1 and R2 here. Only allow <b>.fastq.gz</b> format. Maximum size for each file: <b>20 GB</b>. Please note that uploading your files may take some time, so please refrain from refreshing the page while the data is being uploaded.</p>
                  <div id="drna_tumor_upload_area">
                      <div id="fileuploader_drna_tumor"></div>
                      <div id="drna_tumor_upload_button" class="btn btn-primary start">
                          <span>Start upload</span>
                          <p>{{msg}}</p>
                      </div>
                  </div>
              </div>
  
      <div id="drna_tumor_url_upload">
          <p>Please provide the Google Drive file IDs (e.g., https://drive.google.com/file/d/<b>Google Drive file ID</b> /view) of your
          sequencing files in R1 and R2 fields. Using a share link from Google Drive is available.
          Only allow <b>.fastq</b>/<b>.fq</b> and <b>.gz</b> format.</p>
          <label for="url_drna_tumor_R1">R1:</label><div id="url_drna_tumor_R1_err" style="color:red;"></div>
          <input type="url" class="form-control" id="url_drna_tumor_R1" name="url_drna_tumor_R1" style="margin-bottom: 10px;" />
          <input type="hidden" id="confirmed_url_drna_tumor_R1" name="confirmed_url_drna_tumor_R1" value="" />
          <label for="url_drna_tumor_R2">R2:</label><div id="url_drna_tumor_R2_err" style="color:red;"></div>
          <input type="url" class="form-control" id="url_drna_tumor_R2" name="url_drna_tumor_R2" style="margin-bottom: 10px;" />
          <input type="hidden" id="confirmed_url_drna_tumor_R2" name="confirmed_url_drna_tumor_R2" value="" />
          <div id="drna_tumor_url_confirm_button" class="btn btn-primary start">
            <i class="glyphicon glyphicon-cloud-download"></i>
                  <span>Confirm URLs</span>
          </div>
      </div>
  
      </div>
    </div>
  
    <div class="card text-dark mb-3" style="background-color: #f4f8ff;"> <!--quality check normal-->
      <div class="card-heading">
      <h3 class="card-header" style="background-color: #d0e0fa;">Step 2-2. RNA Reads Upload (Normal sample)</h3></div>
      <div class="card-body">
      Select a method for uploading files:<br />
      <label class="radio-inline">
          <input type="radio" name="drna_normal_upload_method" id="drna_normal_from_browser" value="drna_normal_from_browser" checked />From browser
      </label>
      <label class="radio-inline">
          <input type="radio" name="drna_normal_upload_method" id="drna_normal_from_url" value="drna_normal_from_url"/>From URLs
      </label>
          <input type="hidden" id="drna_N_upload_method" name="drna_N_upload_method" value=""/>
              <div id="drna_normal_browser_upload">
                  <p>Please upload your <b> normal RNA-seq </b> files R1 and R2 here. Only allow <b>.fastq.gz</b> format. Maximum size for each file: <b>20 GB</b>. Please note that uploading your files may take some time, so please refrain from refreshing the page while the data is being uploaded.</p>
                  <div id="drna_normal_upload_area">
                      <div id="fileuploader_drna_normal"></div>
                      <div id="drna_normal_upload_button" class="btn btn-primary start">
                          <span>Start upload</span>
                          <p>{{msg}}</p>
                      </div>
                  </div>
              </div>
  
      <div id="drna_normal_url_upload">
          <p>Please provide the Google Drive file IDs (e.g., https://drive.google.com/file/d/<b>Google Drive file ID</b> /view) of your
          sequencing files in R1 and R2 fields. Using a share link from Google Drive is available.
          Only allow <b>.fastq</b>/<b>.fq</b> and <b>.gz</b> format.</p>
          <label for="url_drna_normal_R1">R1:</label><div id="url_drna_normal_R1_err" style="color:red;"></div>
          <input type="url" class="form-control" id="url_drna_normal_R1" name="url_drna_normal_R1" style="margin-bottom: 10px;" />
          <input type="hidden" id="confirmed_url_drna_normal_R1" name="confirmed_url_drna_normal_R1" value="" />
          <label for="url_drna_normal_R2">R2:</label><div id="url_drna_normal_R2_err" style="color:red;"></div>
          <input type="url" class="form-control" id="url_drna_normal_R2" name="url_drna_normal_R2" style="margin-bottom: 10px;" />
          <input type="hidden" id="confirmed_url_drna_normal_R2" name="confirmed_url_drna_normal_R2" value="" />
          <div id="drna_normal_url_confirm_button" class="btn btn-primary start">
            <i class="glyphicon glyphicon-cloud-download"></i>
                  <span>Confirm URLs</span>
          </div>
      </div>
          <input type="hidden" id="upload_id_drna" name="upload_id_drna" value="" />
      </div>
    </div>
  
  <!-- <! Expression level parameter> -->
  <div class="card text-dark mb-3" style="background-color: #f4f8ff;"> <!--Taxonomic Abundance-->
      <div class="card-heading">
      <h3 class="card-header" style="background-color: #d0e0fa;">Step 3. RNA expression level filtering</h3></div>
      <div class="card-body">
          In this step, we perform RNA expression level filtering to filtering out variants with low expression levels.<br />
      <label class="radio-inline">
          <input type="radio" name="drna_expression_setting" id="drna_expression_default" value="default" checked />Default Settings
      </label>
      <label class="radio-inline">
          <input type="radio" name="drna_expression_setting" id="drna_expression_custom" value="custom" />Customized
      </label>
      <table class="table table-striped table-condensed" name="drna_expression_table">
              <thead>
                <tr>
                  <th>Quast settings</th>
                  <th>Values</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>minimal threshold of tumor RNA expression level (unit: tpm)</td>
                  <td style="width: 50%">
                      <div class="form-group">
                        <label><input name="drna_tumor_expression_threshold" type="number" min="0.0" step="0.5" value="1.0" /> [default: 1.0]</label>
                      </div>
                  </td>
                </tr>
              </tbody>
              <tbody>
                <tr>
                  <td>minimal ratio of tumor RNA expression level to normal RNA expression level</td>
                  <td style="width: 50%">
                      <div class="form-group">
                        <label><input name="drna_minimal_expression_ratio" type="number" min="0.0" step="1.0" value="0.0" /> [default: 0.0 (none)]</label>
                      </div>
                  </td>
                </tr>
              </tbody>
      </table>
  
      </div>
    </div>
  
  <!-- HLA type selection -->
<div class="card text-dark mb-3" style="background-color: #f4f8ff;"> 
  <div class="card-heading">
  <h3 class="card-header" style="background-color: #d0e0fa;">Step 4. HLA genotype selection</h3></div>
  <div class="card-body">
    Before binding affinity prediction, please select specific HLA genotypes.
    Personal HLA types will be predicted during analysis if select "Personal HLA types". Manual selection is also provided to select specific HLA types.<br/>
    <p></p>
  <label class="radio-inline">
      <input type="radio" name="drna_hla_upload_method" id="drna_hla_in_process" value="drna_hla_in_process" checked /> Personal HLA types
  </label>
  <label class="radio-inline">
      <input type="radio" name="drna_hla_upload_method" id="drna_hla_from_bottom" value="drna_hla_from_bottom" /> Manual selection
  </label>
  <input type="hidden" id="drna_hla_upload_method" name="drna_hla_upload_method" value="" />

  <!-- Include in the step -->
  <div id="drna_hla_process">
      <p></p>
      <br>Personal HLA types will be predicted during analysis, and the step of HLA binding prediction will be conducted based on the predicted HLA types.</b>
  </div>
  
      <!-- <! Select HLA types> -->
      <div id="drna_hla_bottom">
          <br>Based on HLA major allele group frequencies, default HLA types are HLA-A*02:01, A*11:01, A*24:02, and A*33:03.
          <p>Maximum number of HLA types: <b>20</b></p>
          <div class="selcenter">
              <select class="DNA-RNA-HLA-multiple" id="DNA-RNA-HLA-multiple" name="DNA-RNA-HLA-multiple" multiple="multiple">
                {% for hla_type in hla_list %}
                  <option value={{hla_type}}>{{hla_type}}</option>
                {% endfor %}          
              </select>
          </div>
          </div>
      </div>
    </div>
  
    <!-- <! Step 5. ic 50 standard> -->
  <div class="card text-dark mb-3" style="background-color: #f4f8ff;"> <!--Taxonomic Abundance-->
      <div class="card-heading">
      <h3 class="card-header" style="background-color: #d0e0fa;">Step 5. Peptide-HLA binding affinity</h3></div>
      <div class="card-body">
          In this step, we provide <i>pvactools</i> to predict binding affinity scores between peptides and specific HLA(s). The default standard of ic50 is as followed, and the standard can be adjusted in customized mode. <b>Noted that stronger binding affinity has lower ic50 number!</b><br/>
      <br><b>No binding (ic50 &#62; 500) | Weak binding (500 &#8805; ic50 &#62; 250) | Intermediate (250 &#8805; ic50 &#62; 50) | Strong binding (50 &#8805; ic50)</b></br>
  
      <label class="radio-inline">
          <input type="radio" name="drna_ic50_setting" id="drna_ic50_default" value="default" checked />Default Settings
      </label>
      <label class="radio-inline">
          <input type="radio" name="drna_ic50_setting" id="drna_ic50_custom" value="custom" />Customized
      </label>
      <table class="table table-striped table-condensed" name="drna_ic50_table">
              <thead>
                <tr>
                  <th>Quast settings</th>
                  <th>Values</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Maximum ic50 for <b>Strong binding</b></td>
                  <td style="width: 50%">
                      <div class="form-group">
                        <label><input onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" name="drna_max_ic_strong" id="drna_max_ic_strong" type="number" min="0" max="10000" step="10" value="50" /> [default: 50]</label>
                      </div>
                  </td>
                </tr>
              </tbody>
              <tbody>
                <tr>
                  <td>Maximum ic50 for <b>Intermediate binding</b></td>
                  <td style="width: 50%">
                      <div class="form-group">
                        <label><input onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" name="drna_max_ic_inter" id="drna_max_ic_inter" type="number" min="0" max="10000" step="10" value="250" /> [default: 250]</label>
                      </div>
                  </td>
                </tr>
              </tbody>
              <tbody>
                <tr>
                  <td>Maximum ic50 for <b>Weak binding</b></td>
                  <td style="width: 50%">
                      <div class="form-group">
                        <label><input onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" name="drna_max_ic_weak" id="drna_max_ic_weak" type="number" min="0" max="10000" step="10" value="500" /> [default: 500]</label>
                      </div>
                  </td>
                </tr>
              </tbody>
      </table>
  
      </div>
    </div>
  
    <!-- Step 6. LC-MS/MS -->
    <div class="card text-dark mb-3" style="background-color: #f4f8ff;"> <!--quality check-->
      <div class="card-heading">
      <h3 class="card-header" style="background-color: #d0e0fa;">Step 6. LC-MS/MS peptides Upload (optional)</h3></div>
      <div class="card-body">
        <p><b> Once an incorrect or missing LC-MS/MS file upload, we will employ the IEDB database as a viable alternative to generate aeTSA. </b></p>
        Select a method for uploading files:<br />
      <label class="radio-inline">
        <input type="radio" name="drna_mass_upload_method" id="drna_mass_from_browser" value="drna_mass_from_browser" checked />From browser
    </label>
    <label class="radio-inline">
        <input type="radio" name="drna_mass_upload_method" id="drna_mass_from_url" value="drna_mass_from_url"/>From URLs
    </label>
        <input type="hidden" id="drna_Ms_upload_method" name="drna_Ms_upload_method" value=""/>
        <div id="drna_mass_browser_upload">
          <p>Please upload your <b> FASTA </b> files consisting of peptide sequences from LC-MS/MS here. Only allow <b>.fasta.gz</b> format.</p><p> Maximum size for each file: <b>1 GB</b>.</p>
          <div id="fileuploader_drna_mass"></div>
        </div>
        
        <div id="drna_mass_url_upload">
          <p>Please provide the Google Drive file IDs (e.g., https://drive.google.com/file/d/<b>Google Drive file ID</b> /view) of your
            peptide sequencing files in fasta format. Using a share link from Google Drive is available.
            Only allow <b>.fasta.gz</b> format.</p>
            <label for="url_drna_Ms">Peptide:</label><div id="url_drna_Ms_err" style="color:red;"></div>
            <input type="url" class="form-control" id="url_drna_Ms" name="url_drna_Ms" style="margin-bottom: 10px;" />
            <input type="hidden" id="drna_mass_confirmed_url" name="drna_mass_confirmed_url" value="" />
            <div id="drna_mass_url_confirm_button" class="btn btn-primary start">
              <i class="glyphicon glyphicon-cloud-download"></i>
                    <span>Confirm the URL</span>
            </div>
        </div>
        
        </div>
      </div>
      <div class="card-heading">
      <h3 class="card-header" style="background-color: #d0e0fa;">Step 7. Privacy Statement</h3></div>
      <div class="card-body">
        NARWHAL NEVER shares users' uploaded data and results with others. All data and metadata of one task will be removed automatically from the server without any copies after <b>7 days</b> of the report generated.
      <p></p>
      <input class="form-check-input" type="checkbox" name="drna_accept_privacy_statement" id="drna_accept_privacy_statement" value="accept" />
      <label class="form-check-label" for="drna_accept_privacy_statement">I have read the Privacy Statement of NARWHAL and accept NARWHAL to process my upload data.</label>
      </div>
    </div>
    <div id="drna_submission_panel">
      <div class="card-heading">
      <h3 class="card-header" style="background-color: #d0e0fa;">Step 7. Data submission</h3></div>
      <div class="card-body">
        <button class="btn btn-default btn-success" type="submit" id="submit_drna">Submit</button>
      </div>
    </div>
</form>
</div>
{% endblock content %}
{% block script %}
<script data-turbolinks-track="true" src="../static/js/jquery/jquery-ui.min.js"></script>
<script data-turbolinks-track="true" type="text/javascript" src="{% static '/js/jquery/bootstrap.min.js' %}"></script>
<script data-turbolinks-track="true" type="text/javascript"
        src="{% static '/js/jquery/bootstrap-select.min.js' %}"></script>
<script data-turbolinks-track="true" type="text/javascript"
        src="{% static '/js/jquery/jquery-ui-1.10.4.custom.min.js' %}"></script>
<script data-turbolinks-track="true" type="text/javascript"
        src="{% static '/js/jquery/jquery.iframe-transport.js' %}"></script>
<script data-turbolinks-track="true" type="text/javascript"
        src="{% static '/js/jquery/jquery.fileupload.js' %}"></script>
<script data-turbolinks-track="true" type="text/javascript" src="{% static '/js/jquery/turbolinks.js' %}"></script>


<script data-turbolinks-track="true" src="../static/js/uploadfile/jquery.form.js"></script>
<script data-turbolinks-track="true" src="../static/js/jquery/get_cookie.js"></script>
<script data-turbolinks-track="true" src="../static/js/uploadfile/sha256.js"></script>
<script data-turbolinks-track="true" src="../static/js/uploadfile/jquery.uploadfile.js"></script>
<script data-turbolinks-track="true" src="../static/js/neoantigen_identification.js"></script>
<script src="../static/js/jquery/bootstrap.min.js"></script>
<!-- <script data-turbolinks-track="true" src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script> -->
{% endblock script %}
